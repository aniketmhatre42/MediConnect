{"ast":null,"code":"// Remove the import that's causing issues and implement an alternative approach\n// that doesn't require an external library\n// import { saveAs } from 'file-saver'; // This line is causing the error\n\n// Base directory for storing face data\nconst FACE_DATA_DIR = 'face_data';\n\n/**\r\n * Saves face descriptor data to a local file in the user's download directory\r\n * @param {string} userId - The unique user ID\r\n * @param {Float32Array} descriptor - The face descriptor data\r\n * @returns {Promise<boolean>} - Whether the save was successful\r\n */\nexport const saveFaceDescriptor = async (userId, descriptor) => {\n  try {\n    console.log(`Saving face descriptor for user ${userId}`);\n\n    // Convert descriptor to regular array for JSON serialization\n    const descriptorArray = Array.from(descriptor);\n    const faceData = {\n      userId,\n      descriptor: descriptorArray,\n      timestamp: new Date().toISOString()\n    };\n\n    // Instead of using file-saver, we'll save to localStorage only\n    // This eliminates the need for the external dependency\n    storeLocalCopy(userId, descriptorArray);\n    console.log(`Face descriptor saved to local storage for user: ${userId}`);\n    return true;\n  } catch (error) {\n    console.error('Error saving face descriptor:', error);\n    return false;\n  }\n};\n\n/**\r\n * Loads face descriptor data from localStorage (as files can't be directly accessed)\r\n * @param {string} userId - The unique user ID\r\n * @returns {Float32Array|null} - The face descriptor or null if not found\r\n */\nexport const loadFaceDescriptor = userId => {\n  try {\n    // Local storage is used as a cache since we can't directly read files\n    const localCopy = getLocalCopy(userId);\n    if (localCopy) {\n      return new Float32Array(localCopy);\n    }\n    return null;\n  } catch (error) {\n    console.error('Error loading face descriptor:', error);\n    return null;\n  }\n};\n\n/**\r\n * Stores a local copy of the face data in localStorage for immediate use\r\n * @param {string} userId - The unique user ID\r\n * @param {Array} descriptorArray - The face descriptor array\r\n */\nconst storeLocalCopy = (userId, descriptorArray) => {\n  try {\n    const faceDescriptors = JSON.parse(localStorage.getItem('face_descriptors') || '[]');\n\n    // Check if this user already has a descriptor\n    const existingIndex = faceDescriptors.findIndex(item => item.userId === userId);\n    if (existingIndex >= 0) {\n      faceDescriptors[existingIndex].descriptor = descriptorArray;\n    } else {\n      faceDescriptors.push({\n        userId,\n        descriptor: descriptorArray,\n        timestamp: new Date().toISOString()\n      });\n    }\n    localStorage.setItem('face_descriptors', JSON.stringify(faceDescriptors));\n  } catch (e) {\n    console.error('Error storing local copy of face data:', e);\n  }\n};\n\n/**\r\n * Gets a local copy of the face descriptor from localStorage\r\n * @param {string} userId - The unique user ID\r\n * @returns {Array|null} - The descriptor array or null if not found\r\n */\nconst getLocalCopy = userId => {\n  try {\n    const faceDescriptors = JSON.parse(localStorage.getItem('face_descriptors') || '[]');\n    const userFace = faceDescriptors.find(item => item.userId === userId);\n    return userFace ? userFace.descriptor : null;\n  } catch (e) {\n    console.error('Error getting local copy of face data:', e);\n    return null;\n  }\n};\n\n/**\r\n * Removes a face descriptor from both file and localStorage\r\n * @param {string} userId - The unique user ID\r\n * @returns {boolean} - Whether the removal was successful\r\n */\nexport const removeFaceDescriptor = userId => {\n  try {\n    // Remove from localStorage\n    const faceDescriptors = JSON.parse(localStorage.getItem('face_descriptors') || '[]');\n    const filteredDescriptors = faceDescriptors.filter(item => item.userId !== userId);\n    localStorage.setItem('face_descriptors', JSON.stringify(filteredDescriptors));\n    console.log(`Face descriptor for user ${userId} removed from local storage`);\n    console.log(`Note: The saved file ${FACE_DATA_DIR}_${userId}.json must be deleted manually`);\n    return true;\n  } catch (error) {\n    console.error('Error removing face descriptor:', error);\n    return false;\n  }\n};\n\n/**\r\n * Lists all user IDs with stored face descriptors in localStorage\r\n * @returns {Array<string>} - Array of user IDs\r\n */\nexport const listFaceUsers = () => {\n  try {\n    const faceDescriptors = JSON.parse(localStorage.getItem('face_descriptors') || '[]');\n    return faceDescriptors.map(item => item.userId);\n  } catch (error) {\n    console.error('Error listing face users:', error);\n    return [];\n  }\n};","map":{"version":3,"names":["FACE_DATA_DIR","saveFaceDescriptor","userId","descriptor","console","log","descriptorArray","Array","from","faceData","timestamp","Date","toISOString","storeLocalCopy","error","loadFaceDescriptor","localCopy","getLocalCopy","Float32Array","faceDescriptors","JSON","parse","localStorage","getItem","existingIndex","findIndex","item","push","setItem","stringify","e","userFace","find","removeFaceDescriptor","filteredDescriptors","filter","listFaceUsers","map"],"sources":["D:/Movies/Aniket/test2/test/src/services/localFaceStorage.js"],"sourcesContent":["// Remove the import that's causing issues and implement an alternative approach\r\n// that doesn't require an external library\r\n// import { saveAs } from 'file-saver'; // This line is causing the error\r\n\r\n// Base directory for storing face data\r\nconst FACE_DATA_DIR = 'face_data';\r\n\r\n/**\r\n * Saves face descriptor data to a local file in the user's download directory\r\n * @param {string} userId - The unique user ID\r\n * @param {Float32Array} descriptor - The face descriptor data\r\n * @returns {Promise<boolean>} - Whether the save was successful\r\n */\r\nexport const saveFaceDescriptor = async (userId, descriptor) => {\r\n  try {\r\n    console.log(`Saving face descriptor for user ${userId}`);\r\n    \r\n    // Convert descriptor to regular array for JSON serialization\r\n    const descriptorArray = Array.from(descriptor);\r\n    \r\n    const faceData = {\r\n      userId,\r\n      descriptor: descriptorArray,\r\n      timestamp: new Date().toISOString()\r\n    };\r\n    \r\n    // Instead of using file-saver, we'll save to localStorage only\r\n    // This eliminates the need for the external dependency\r\n    storeLocalCopy(userId, descriptorArray);\r\n    \r\n    console.log(`Face descriptor saved to local storage for user: ${userId}`);\r\n    return true;\r\n  } catch (error) {\r\n    console.error('Error saving face descriptor:', error);\r\n    return false;\r\n  }\r\n};\r\n\r\n/**\r\n * Loads face descriptor data from localStorage (as files can't be directly accessed)\r\n * @param {string} userId - The unique user ID\r\n * @returns {Float32Array|null} - The face descriptor or null if not found\r\n */\r\nexport const loadFaceDescriptor = (userId) => {\r\n  try {\r\n    // Local storage is used as a cache since we can't directly read files\r\n    const localCopy = getLocalCopy(userId);\r\n    if (localCopy) {\r\n      return new Float32Array(localCopy);\r\n    }\r\n    return null;\r\n  } catch (error) {\r\n    console.error('Error loading face descriptor:', error);\r\n    return null;\r\n  }\r\n};\r\n\r\n/**\r\n * Stores a local copy of the face data in localStorage for immediate use\r\n * @param {string} userId - The unique user ID\r\n * @param {Array} descriptorArray - The face descriptor array\r\n */\r\nconst storeLocalCopy = (userId, descriptorArray) => {\r\n  try {\r\n    const faceDescriptors = JSON.parse(localStorage.getItem('face_descriptors') || '[]');\r\n    \r\n    // Check if this user already has a descriptor\r\n    const existingIndex = faceDescriptors.findIndex(item => item.userId === userId);\r\n    \r\n    if (existingIndex >= 0) {\r\n      faceDescriptors[existingIndex].descriptor = descriptorArray;\r\n    } else {\r\n      faceDescriptors.push({\r\n        userId,\r\n        descriptor: descriptorArray,\r\n        timestamp: new Date().toISOString()\r\n      });\r\n    }\r\n    \r\n    localStorage.setItem('face_descriptors', JSON.stringify(faceDescriptors));\r\n  } catch (e) {\r\n    console.error('Error storing local copy of face data:', e);\r\n  }\r\n};\r\n\r\n/**\r\n * Gets a local copy of the face descriptor from localStorage\r\n * @param {string} userId - The unique user ID\r\n * @returns {Array|null} - The descriptor array or null if not found\r\n */\r\nconst getLocalCopy = (userId) => {\r\n  try {\r\n    const faceDescriptors = JSON.parse(localStorage.getItem('face_descriptors') || '[]');\r\n    const userFace = faceDescriptors.find(item => item.userId === userId);\r\n    return userFace ? userFace.descriptor : null;\r\n  } catch (e) {\r\n    console.error('Error getting local copy of face data:', e);\r\n    return null;\r\n  }\r\n};\r\n\r\n/**\r\n * Removes a face descriptor from both file and localStorage\r\n * @param {string} userId - The unique user ID\r\n * @returns {boolean} - Whether the removal was successful\r\n */\r\nexport const removeFaceDescriptor = (userId) => {\r\n  try {\r\n    // Remove from localStorage\r\n    const faceDescriptors = JSON.parse(localStorage.getItem('face_descriptors') || '[]');\r\n    const filteredDescriptors = faceDescriptors.filter(item => item.userId !== userId);\r\n    localStorage.setItem('face_descriptors', JSON.stringify(filteredDescriptors));\r\n    \r\n    console.log(`Face descriptor for user ${userId} removed from local storage`);\r\n    console.log(`Note: The saved file ${FACE_DATA_DIR}_${userId}.json must be deleted manually`);\r\n    return true;\r\n  } catch (error) {\r\n    console.error('Error removing face descriptor:', error);\r\n    return false;\r\n  }\r\n};\r\n\r\n/**\r\n * Lists all user IDs with stored face descriptors in localStorage\r\n * @returns {Array<string>} - Array of user IDs\r\n */\r\nexport const listFaceUsers = () => {\r\n  try {\r\n    const faceDescriptors = JSON.parse(localStorage.getItem('face_descriptors') || '[]');\r\n    return faceDescriptors.map(item => item.userId);\r\n  } catch (error) {\r\n    console.error('Error listing face users:', error);\r\n    return [];\r\n  }\r\n};\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}